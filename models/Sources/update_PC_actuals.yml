version: 2

sources:
  - name: ae_staging
    description: Actuals updates extracted from APR Outcomes data collection Excel model tables 3A, 3B and 3E.
    tables:
      - name: source_pc_actuals_updates
        description: >
          One record per order. Includes cancelled and deleted orders.
        columns:
          - name: updated_at
            tests:
              - not_null
          - name: amp_name
            tests:
              - not_null
              - relationships:
                  to: ref('D_Ofwat_amp')
                  field: amp_name
          - name: OFWAT_Year
            tests:
              - not_null
              - relationships:
                  to: ref('D_Date_OFWAT')
                  field: Ofwat_Year
          - name: submission_status
            tests:
              - not_null
              - accepted_values:
                  values: ['actual']
          - name: unique_id
            tests:
              - not_null
              - relationships:
                  to: ref('D_PC_company_amp')
                  field: unique_id
          - name: company_acronym
            # tests:
            #   - not_null
            #   - relationships:
            #       to: ref('D_Water_company')
            #       field: company_acronym
          - name: company_name
            tests:
              - not_null
              - relationships:
                  to: ref('D_Water_company')
                  field: water_company_name
          - name: pcl
            tests:
          - name: pcl_met
            tests:
              - not_null
              - accepted_values:
                  values: ['No', 'Yes', '-']
          - name: outperformance_or_underperformance_payment
            tests:
          - name: forecast_of_total_2020_25_outperformance_or_underperformance_payment
            tests:

with PR14 as (
    select * from {{ ref('PR14_FD_outcome_New_CSV_View') }}
),
odi_type as (
    select * from {{ ref('D_ODI_type') }}
),
D_ODI_form as (
    select * from {{ ref('D_ODI_form') }}
),
PCCompanyAMP as (
    select * from {{ ref('D_PC_Company_AMP') }}
),
/*added company and element because more than 1 records of pc and odi 
where getting pulled when they were not considered*/
Company as (
    select * from {{ ref('D_Company') }}
),
element as (
    select * from {{ ref('D_Elements') }}
),

final as (
 select {{dbt_utils.hash(dbt_utils.concat(['performance_commitment','primary_category','odi_type.ODI_id','D_ODI_form.ODI_form_id','Company','element.element_acronym']))}} [PC_ODI_id]
	  , PR14.[unique_id]
      , element.element_acronym
      , Company
      , performance_commitment
      , primary_category
      , PR14.odi_type
      , odi_type.ODI_id
      , PR14.odi_form
      , D_ODI_form.ODI_form_id
      , in_period_odi
      , vanilla_odi
  FROM PR14 
left join PCCompanyAMP on
 PR14.[unique_id]=PCCompanyAMP.[unique_id]
left join odi_type on
 PR14.[odi_type]=odi_type.[ODI_name]
left join D_ODI_form on
 PR14.[odi_form]=D_ODI_form.[odi_form_name]
left join Company on
 PR14.[Company]=Company.[Company_name]
left join element on
 PR14.[element_acronym]=element.element_acronym
)

select * from final